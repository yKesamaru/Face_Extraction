<!DOCTYPE html><html><head>
      <title>README</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:////home/terms/.vscode/extensions/shd101wyy.markdown-preview-enhanced-0.8.14/crossnote/dependencies/katex/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h2 id="はじめに">はじめに </h2>
<p>顔画像データセットを作成する際、一般的にはクローリングによって作成するかと思います。
この方法だとデータのクリーニングが大変です。</p>
<ul>
<li>自撮り加工が大変多い</li>
<li>関連した別人が混ざる</li>
<li>年齢差が大きすぎるデータが混ざる</li>
<li>ぼやけている
これらを最終的には目視で行わなければなりません。
<code>JAPANESE FACE V1</code><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>を作製した時は、最終チェックはすべて目視で行いました。</li>
</ul>
<p>これとは異なる方法として、インタビューなどの動画から顔画像データを抽出する方法も存在します。
人数をかせぐことは出来ませんが、上記のデメリットはすべて解消されます。</p>
<p>この記事では後者の「インタビューなどの動画から顔画像データを抽出する方法」について、<code>FACE01</code><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>を使って行います。</p>
<p><img src="assets/eye-catch.png" alt=""></p>
<h2 id="環境">環境 </h2>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>$ inxi <span class="token parameter variable">-Sxxx</span> <span class="token parameter variable">--filter</span>
System:
  Kernel: <span class="token number">6.8</span>.0-47-generic x86_64 bits: <span class="token number">64</span> compiler: N/A Desktop: GNOME <span class="token number">42.9</span>
    tk: GTK <span class="token number">3.24</span>.33 wm: gnome-shell dm: GDM3 <span class="token number">42.0</span>
    Distro: Ubuntu <span class="token number">22.04</span>.5 LTS <span class="token punctuation">(</span>Jammy Jellyfish<span class="token punctuation">)</span>
</code></pre><h2 id="環境構築">環境構築 </h2>
<h3 id="python仮想環境構築">Python仮想環境構築 </h3>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>terms@terms:~/ドキュメント/Face_Extraction$ python3 <span class="token parameter variable">-m</span> venv ./venv
terms@terms:~/ドキュメント/Face_Extraction$ <span class="token builtin class-name">.</span> venv/bin/activate
<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> terms@terms:~/ドキュメント/Face_Extraction$ pip <span class="token function">install</span> <span class="token parameter variable">-U</span> pip wheel setuptools
Requirement already satisfied: pip <span class="token keyword keyword-in">in</span> ./venv/lib/python3.10/site-packages <span class="token punctuation">(</span><span class="token number">22.0</span>.2<span class="token punctuation">)</span>
Collecting pip
  Using cached pip-24.2-py3-none-any.whl <span class="token punctuation">(</span><span class="token number">1.8</span> MB<span class="token punctuation">)</span>
Collecting wheel
  Using cached wheel-0.44.0-py3-none-any.whl <span class="token punctuation">(</span><span class="token number">67</span> kB<span class="token punctuation">)</span>
Requirement already satisfied: setuptools <span class="token keyword keyword-in">in</span> ./venv/lib/python3.10/site-packages <span class="token punctuation">(</span><span class="token number">59.6</span>.0<span class="token punctuation">)</span>
Collecting setuptools
  Downloading setuptools-75.2.0-py3-none-any.whl <span class="token punctuation">(</span><span class="token number">1.2</span> MB<span class="token punctuation">)</span>
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class="token number">1.2</span>/1.2 MB <span class="token number">8.3</span> MB/s eta <span class="token number">0</span>:00:00
Installing collected packages: wheel, setuptools, pip
  Attempting uninstall: setuptools
    Found existing installation: setuptools <span class="token number">59.6</span>.0
    Uninstalling setuptools-59.6.0:
      Successfully uninstalled setuptools-59.6.0
  Attempting uninstall: pip
    Found existing installation: pip <span class="token number">22.0</span>.2
    Uninstalling pip-22.0.2:
      Successfully uninstalled pip-22.0.2
Successfully installed pip-24.2 setuptools-75.2.0 wheel-0.44.0
<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> terms@terms:~/ドキュメント/Face_Extraction$
</code></pre><h3 id="face01をdockerで導入">FACE01をDOCKERで導入 </h3>
<p><a href="https://ykesamaru.github.io/FACE01_DEV/step_by_step/docker.html">下記</a>に書いてあるとおりに<code>Docker image</code>をプルする。</p>
<p><img src="assets/2024-10-23-16-34-21.png" alt=""></p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token function">docker</span> pull tokaikaoninsho/face01_gpu
</code></pre><p>確認。ここでは予めダウンロードしておいた<code>Docker image</code>がリストされています。</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>$ <span class="token function">docker</span> images
REPOSITORY                     TAG        IMAGE ID       CREATED        SIZE
tokaikaoninsho/face01_gpu      <span class="token number">3.0</span>.03_3   ce2952ad62d6   <span class="token number">2</span> months ago   <span class="token number">22</span>.3GB
</code></pre><p><a href="https://ykesamaru.github.io/FACE01_DEV/step_by_step/docker.html#dockerguixhost">ドキュメント</a>にあるように、GUIを使えるようにしておく。</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>xhost +local:
</code></pre><p>この部分がよくわからない方は<a href="https://zenn.dev/ykesamaru/articles/add7d844f56516">以下</a>を参考にしてください。</p>
<p><code>DockerでGUIアプリケーションを開く基本的な押さえどころ</code></p>
<p><a href="https://zenn.dev/ykesamaru/articles/add7d844f56516">https://zenn.dev/ykesamaru/articles/add7d844f56516</a></p>
<p>永続化のためのフォルダを指定しておきたいので、<a href="https://ykesamaru.github.io/FACE01_DEV/step_by_step/docker.html#dockerguixhost">以下のようにしてコンテナを起動</a>します。</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">--gpus</span> all <span class="token parameter variable">-e</span> <span class="token assign-left variable"><span class="token environment constant">DISPLAY</span></span><span class="token operator">=</span><span class="token environment constant">$DISPLAY</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> /tmp/.X11-unix:/tmp/.X11-unix <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> /path/to/host/folder:/path/to/container/folder <span class="token punctuation">\</span>
    <span class="token operator">&lt;</span>image id<span class="token operator">&gt;</span>
</code></pre><p><img src="assets/2024-10-23-16-42-37.png" alt=""></p>
<p>以下はドキュメントに実際描かれている内容の転載です。</p>
<blockquote>
<p>ここで、'/path/to/host/folder'はホスト側の永続化したいデータを保存するフォルダパスを指定し、'/path/to/container/folder'はコンテナ内でそのデータを利用するためのフォルダパスを指定します。</p>
<p>例えば、ホストの'/home/user/dataフォルダ'をコンテナ内の'/mnt/data'にマウントしたい場合は、以下のようになります。</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">--gpus</span> all <span class="token parameter variable">-e</span> <span class="token assign-left variable"><span class="token environment constant">DISPLAY</span></span><span class="token operator">=</span><span class="token environment constant">$DISPLAY</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> /tmp/.X11-unix:/tmp/.X11-unix <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> /home/user/data:/mnt/data <span class="token punctuation">\</span>
    <span class="token operator">&lt;</span>image id<span class="token operator">&gt;</span>
</code></pre></blockquote>
<p><code>/home/terms/ドキュメント/Face_Extraction/assets/</code>ディレクトリに<code>interview.mp4</code>としてテスト用動画を用意してあります。
今回はこの動画ファイルから顔画像ファイルを抽出したいので、このディレクトリを指定してコンテナを起動します。</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">--gpus</span> all <span class="token parameter variable">-e</span> <span class="token assign-left variable"><span class="token environment constant">DISPLAY</span></span><span class="token operator">=</span><span class="token environment constant">$DISPLAY</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> /tmp/.X11-unix:/tmp/.X11-unix <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> /home/terms/ドキュメント/Face_Extraction/assets:/mnt/data <span class="token punctuation">\</span>
    ce2952ad62d6
</code></pre><p>コンテナを上記のように指定して起動すると、ホスト側の<code>/home/terms/ドキュメント/Face_Extraction/assets</code>ディレクトリがコンテナ側の<code>/mnt/data</code>ディレクトリに接続されます。</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token punctuation">(</span>venv<span class="token punctuation">)</span> terms@terms:~/ドキュメント/Face_Extraction$ <span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">--gpus</span> all <span class="token parameter variable">-e</span> <span class="token assign-left variable"><span class="token environment constant">DISPLAY</span></span><span class="token operator">=</span><span class="token environment constant">$DISPLAY</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> /tmp/.X11-unix:/tmp/.X11-unix <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> /home/terms/ドキュメント/Face_Extraction/assets:/mnt/data <span class="token punctuation">\</span>
    ce2952ad62d6

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
<span class="token operator">==</span> CUDA <span class="token operator">==</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>

CUDA Version <span class="token number">11.6</span>.1

Container image Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2016</span>-2023, NVIDIA CORPORATION <span class="token operator">&amp;</span> AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available <span class="token keyword keyword-in">in</span> this container at /NGC-DL-CONTAINER-LICENSE <span class="token keyword keyword-for">for</span> your convenience.

*************************
** DEPRECATION NOTICE<span class="token operator">!</span> **
*************************
THIS IMAGE IS DEPRECATED and is scheduled <span class="token keyword keyword-for">for</span> DELETION.
    https://gitlab.com/nvidia/container-images/cuda/blob/master/doc/support-policy.md

docker@056e52013385:~/FACE01_DEV$ <span class="token builtin class-name">.</span> bin/activate
<span class="token punctuation">(</span>FACE01_DEV<span class="token punctuation">)</span> docker@056e52013385:~/FACE01_DEV$ <span class="token function">ls</span> /mnt/data
<span class="token number">2024</span>-10-23-16-34-21.png  <span class="token number">2024</span>-10-23-16-42-37.png  eye-catch.png  interview.mp4
</code></pre><p><code>/mnt/data/interview.mp4</code>に対して、顔画像ファイル抽出処理をしていきます。</p>
<h2 id="configiniを調整する"><code>config.ini</code>を調整する </h2>
<p><code>FACE01</code>の<code>DOCKER</code>イメージには<code>gedit</code>テキストエディタが付属します。<code>vim</code>も付属するので好きな方を選んで起動してください。</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token punctuation">(</span>FACE01_DEV<span class="token punctuation">)</span> docker@a5f5d24d9fba:~/FACE01_DEV$ <span class="token function">ls</span>
Docker_INSTALL_FACE01.sh  assets  build       docs     face01lib  lib    noFace  preset_face_images  pyvenv.cfg            share
SystemCheckLock           bin     config.ini  example  include    lib64  output  pyproject.toml      requirements_dev.txt
<span class="token punctuation">(</span>FACE01_DEV<span class="token punctuation">)</span> docker@a5f5d24d9fba:~/FACE01_DEV$ gedit config.ini 

<span class="token punctuation">(</span>gedit:34<span class="token punctuation">)</span>: dbind-WARNING **: <span class="token number">19</span>:16:54.532: Couldn<span class="token string">'t connect to accessibility bus: Failed to connect to socket /run/user/1000/at-spi/bus_1: そのようなファイルやディレクトリはありません

** (gedit:34): WARNING **: 19:16:54.880: Could not load theme icon text-x-generic: Icon '</span>text-x-generic' not present <span class="token keyword keyword-in">in</span> theme Yaru-red
</code></pre><p><img src="assets/2024-10-23-19-17-39.png" alt=""></p>
<p>基本的に<code>FACE01</code>は<code>config.ini</code>ファイルを編集して設定を行います。</p>
<p>デフォルトで幾つかのセクションが用意されています。すべてのセクションは<code>[DEFAULT]</code>セクションを継承します。
新しいセクションを作成するには<code>[DEFAULT]</code>セクションから変更する部分だけを抽出して設定してください。</p>
<p>くわしくは<a href="https://ykesamaru.github.io/FACE01_DEV/step_by_step/config_ini.html">こちら</a>をご参照ください。</p>
<p><img src="assets/2024-10-23-20-32-42.png" alt=""></p>
<p>今回は予め用意されている<code>[LIGHTWEIGHT_GUI]</code>セクションを元に内容を変更し、これを[CROP_FACES]セクションとして使用します。</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token punctuation">[</span>DISPLAY_GUI<span class="token punctuation">]</span>
<span class="token comment"># [DISPLAY_GUI] section is example for display window.</span>
<span class="token comment"># [DISPLAY_GUI] section inherits from the [DEFAULT] section.</span>
headless <span class="token operator">=</span> False
deep_learning_model <span class="token operator">=</span> <span class="token number">1</span>
similar_percentage <span class="token operator">=</span> <span class="token number">90</span>
preset_face_images_jitters <span class="token operator">=</span> <span class="token number">10</span>
min_detection_confidence <span class="token operator">=</span> <span class="token number">0.8</span>
mode <span class="token operator">=</span> cnn
use_pipe <span class="token operator">=</span> False
same_time_recognize <span class="token operator">=</span> <span class="token number">1</span>
movie <span class="token operator">=</span> interview.mp4
target_rectangle <span class="token operator">=</span> True
show_overlay <span class="token operator">=</span> True
show_percentage <span class="token operator">=</span> True
show_name <span class="token operator">=</span> True
frame_skip <span class="token operator">=</span> <span class="token number">2</span>
number_of_crops <span class="token operator">=</span> <span class="token number">0</span>
</code></pre><p>コードは<a href="https://github.com/yKesamaru/FACE01_DEV/blob/master/example/display_GUI_window.py#L1"><code>example/display_GUI_window.py</code></a>を使用します。</p>
<p><a href="https://github.com/yKesamaru/FACE01_DEV/blob/1cab4e4ceeeea45888d4f54f6c8da1be34e46b52/example/display_GUI_window.py#L1-L123">https://github.com/yKesamaru/FACE01_DEV/blob/1cab4e4ceeeea45888d4f54f6c8da1be34e46b52/example/display_GUI_window.py#L1-L123</a></p>
<p>次に、<code>interview.mp4</code>からとった顔画像ファイルを保存します。</p>
<p><img src="assets/%E9%98%BF%E9%83%A8%E6%85%8E%E4%B9%8B%E4%BB%8B_default.png" alt=""></p>
<p>これを以下のディレクトリにコピーします。</p>
<p><code>~/FACE01_DEV/preset_face_images/</code></p>
<p>コピーする際パスワードを聞かれます。パスワードは<code>docker</code>です。</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token punctuation">(</span>FACE01_DEV<span class="token punctuation">)</span> docker@a5f5d24d9fba:~/FACE01_DEV$ <span class="token function">ls</span> /mnt/data
<span class="token number">2024</span>-10-23-16-34-21.png  <span class="token number">2024</span>-10-23-19-17-39.png  eye-catch.png  interview.mp4
<span class="token number">2024</span>-10-23-16-42-37.png  <span class="token number">2024</span>-10-23-20-32-42.png  face_crop.py   阿部慎之介_default.png
<span class="token punctuation">(</span>FACE01_DEV<span class="token punctuation">)</span> docker@a5f5d24d9fba:~/FACE01_DEV$ <span class="token function">cp</span> /mnt/data/阿部慎之介_default.png ~/FACE01_DEV/preset_face_images/
cp: 通常ファイル <span class="token string">'/home/docker/FACE01_DEV/preset_face_images/阿部慎之介_default.png'</span> を作成できません: 許可がありません
<span class="token punctuation">(</span>FACE01_DEV<span class="token punctuation">)</span> docker@a5f5d24d9fba:~/FACE01_DEV$ <span class="token function">sudo</span> <span class="token operator">!</span><span class="token operator">!</span>
<span class="token function">sudo</span> <span class="token function">cp</span> /mnt/data/阿部慎之介_default.png ~/FACE01_DEV/preset_face_images/
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> <span class="token function">docker</span> のパスワード: 
</code></pre><pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token punctuation">(</span>FACE01_DEV<span class="token punctuation">)</span> docker@b8ddca6a1b03:~/FACE01_DEV$ python ./example/display_GUI_window.py
</code></pre><p><img src="assets/output.gif" alt=""></p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token punctuation">(</span>FACE01_DEV<span class="token punctuation">)</span> docker@b8ddca6a1b03:~/FACE01_DEV$ <span class="token function">mv</span> ./output/*.png /mnt/data/output/
</code></pre><p>これによって、ホスト側にクロップされた顔画像ファイルを移しました。</p>
<p><img src="assets/2024-10-24-12-02-53.png" alt=""></p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://github.com/yKesamaru/FACE01_trained_models">日本人顔認識のための学習モデル</a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://github.com/yKesamaru/FACE01_DEV">FACE01は日本人の顔に最適化された顔学習モデルJAPANESE FACEと、Pythonで書かれたオープンソースのリファレンス実装です。</a> <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>